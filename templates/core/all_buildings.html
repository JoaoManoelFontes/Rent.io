{% extends 'base.html' %} {% block title %}{{title}}{% endblock %} 
{% load static %}
{% load util %}
{% block extrahead %} 
    <link rel="stylesheet" href="{% static 'css/all_properties.css' %}">
{% endblock %}
{% block content%} 
<section class="section_card">
    <br>
    <div class="container">
        <h2 class="lead" id="section-main-title">Todos os prédios</h2>
        <hr />
    </div>
    <div class="container" id="section-nav">
            <form action="" method="get" id="section-search-form">
                <input type="text" name="q" id="section-search-input" placeholder="Pesquisar imóvel"/>
                <button type="submit" id="section-search-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                  </svg></button>
            </form>
            <button class="filter-link" onclick="filterItem()">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  style="margin-bottom: 3px"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-filter"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"
                  />
                </svg>
                <span>Filtrar</span>
              </button>
    </div>
    <br>
    <div class="trending-carrousel">
        {% for Building in buildings %}
        {% if Building.vacant > 0 %}
        <a class="card-link" href="{% url 'building_detail' Building.id %}">
            <div class="card">
                <img class="card-image" src="{{Building|get_property_image}}" alt="img-card">
                <p class="card-title">{{Building.name}}</p>
                <p class="card-subtitle">{{Building.city}}</p>
                <div class="card-info">
                    <div class="icon-container">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-building" viewBox="0 0 16 16">
                            <path d="M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Z"/>
                            <path d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1Zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3V1Z"/>
                        </svg>
                        {% if Building.vacant > 1 %}
                        <p class="card-text2">{{Building.vacant}} apartamentos disponíveis</p>
                        {% else %}
                        <p class="card-text2">{{Building.vacant}} apartamento disponível</p>
                        {% endif %}
                    </div>
                </div>
                <p class="card-price" >A partir de <strong>R$ {{Building.min_price.base_price}}</strong></p>
            </div>
        </a>
        {% endif %}
        <br>
        {% endfor %}
    </div>    
</section>
<div id="filterModal" class="modal">
    <div class="modal-content">
      <div class="title-filter">
        <h1>Filtro</h1>
      </div>
      <hr />
      <form>
        <div class="title-filter">
          <h5>Insira as informações do prédio que você procura</h5>
        </div>
        <br />
        <div class="form-group">
          <div class="radio-tile-group">
            <div class="input-container">
              <input
                id="elevator"
                class="radio-button"
                type="checkbox"
                name="elevator"
              />
              <div class="radio-tile">
                <div class="icon garage-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-up" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"/>
                </svg>
                </div>
                <label for="elevator" class="radio-tile-label">Elevador</label>
              </div>
            </div>
  
            <div class="input-container">
              <input
                id="concierge"
                class="radio-button"
                type="checkbox"
                name="concierge"
              />
              <div class="radio-tile">
                <div class="icon backyard-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-building-lock" viewBox="0 0 16 16">
                    <path d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6.5a.5.5 0 0 1-1 0V1H3v14h3v-2.5a.5.5 0 0 1 .5-.5H8v4H3a1 1 0 0 1-1-1V1Z"/>
                    <path d="M4.5 2a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM9 13a1 1 0 0 1 1-1v-1a2 2 0 1 1 4 0v1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-2Zm3-3a1 1 0 0 0-1 1v1h2v-1a1 1 0 0 0-1-1Z"/>
                </svg>
                </div>
                <label for="concierge" class="radio-tile-label">Portaria</label>
              </div>
            </div>
  
            <div class="input-container">
              <input id="recreation_area" class="radio-button" type="checkbox" name="recreation_area" />
              <div class="radio-tile">
                <div class="icon car-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-water" viewBox="0 0 16 16">
                    <path d="M.036 3.314a.5.5 0 0 1 .65-.278l1.757.703a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.757-.703a.5.5 0 1 1 .372.928l-1.758.703a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0L.314 3.964a.5.5 0 0 1-.278-.65zm0 3a.5.5 0 0 1 .65-.278l1.757.703a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.757-.703a.5.5 0 1 1 .372.928l-1.758.703a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0L.314 6.964a.5.5 0 0 1-.278-.65zm0 3a.5.5 0 0 1 .65-.278l1.757.703a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.757-.703a.5.5 0 1 1 .372.928l-1.758.703a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0L.314 9.964a.5.5 0 0 1-.278-.65zm0 3a.5.5 0 0 1 .65-.278l1.757.703a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.014-.406a2.5 2.5 0 0 1 1.857 0l1.015.406a1.5 1.5 0 0 0 1.114 0l1.757-.703a.5.5 0 1 1 .372.928l-1.758.703a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0l-1.014-.406a1.5 1.5 0 0 0-1.114 0l-1.015.406a2.5 2.5 0 0 1-1.857 0l-1.757-.703a.5.5 0 0 1-.278-.65z"/>
                </svg>
                </div>
                <label for="recreation_area" class="radio-tile-label">Lazer</label>
              </div>
            </div>
          </div>
        </div>
        <!-- #TODO: modificar o campo de preço base
        <div class="form-group">
          <label for="base_price">Preço base</label>
          <input type="number" name="base_price" />
        </div>
        -->
        <br>
          <div class="form-group">
              <div class="wrapper">
                  <div>
                      <h4>Faixa de preço</h4>
                      <p>Preço mínimo e máximo dos apartamentos</p>
                  </div>
                  <div class="price-input">
                      <div class="field">
                          <span>Min</span>
                          <input type="number" name="init_base_price" class="input-min" value="2500" />
                      </div>
                      <div class="separator">-</div>
                      <div class="field">
                      <span>Max</span>
                      <input type="number" name="end_base_price" class="input-max" value="7500" />
                      </div>
                  </div>
                  <div class="slider">
                      <div class="progress"></div>
                  </div>
                  <div class="range-input">
                      <input
                      type="range"
                      class="range-min"
                      min="0"
                      max="10000"
                      value="2500"
                      step="100"
                      />
                      <input
                      type="range"
                      class="range-max"
                      min="0"
                      max="10000"
                      value="7500"
                      step="100"
                      />
                  </div>
              </div>
          </div>
          <br>
          <!-- #TODO: modificar o campo de área
          <div class="form-group">
              <label for="area">Área</label>
              <input type="number" name="area" />
          </div>
          -->
        <div class="button-group">
          <button class="cancel-button" id="cancelFilter" type="button">
            <span>Cancelar</span>
          </button>
          <button class="filter-button" id="confirmFilter" type="submit">
            Filtrar
          </button>
        </div>
      </form>
    </div>
  </div>
  <script>
    let modal = document.getElementById("filterModal");
    let confirmButton = document.getElementById("confirmFilter");
    let cancelButton = document.getElementById("cancelFilter");
  
    function filterItem(itemId) {
      // Primeiro, exibir o modal de confirmação
      modal.style.display = "block";
  
      confirmButton.onclick = function () {
        console.log(`Filtrar`);
  
        // Fechar o modal
  
        modal.style.display = "none";
      };
  
      // Quando o usuário clica no botão Cancelar
      cancelButton.onclick = function () {
        // Não faça nada
        console.log("Operação de filtragem cancelada.");
  
        // Fechar o modal
        modal.style.display = "none";
      };
    }
  </script>
  
  <script>
    const rangeInput = document.querySelectorAll(".range-input input"),
      priceInput = document.querySelectorAll(".price-input input"),
      range = document.querySelector(".slider .progress");
    let priceGap = 200;
  
    priceInput.forEach((input) => {
      input.addEventListener("input", (e) => {
        let minPrice = parseInt(priceInput[0].value),
          maxPrice = parseInt(priceInput[1].value);
  
        if (maxPrice - minPrice >= priceGap && maxPrice <= rangeInput[1].max) {
          if (e.target.className === "input-min") {
            rangeInput[0].value = minPrice;
            range.style.left = (minPrice / rangeInput[0].max) * 100 + "%";
          } else {
            rangeInput[1].value = maxPrice;
            range.style.right = 100 - (maxPrice / rangeInput[1].max) * 100 + "%";
          }
        }
      });
    });
  
    rangeInput.forEach((input) => {
      input.addEventListener("input", (e) => {
        let minVal = parseInt(rangeInput[0].value),
          maxVal = parseInt(rangeInput[1].value);
  
        if (maxVal - minVal < priceGap) {
          if (e.target.className === "range-min") {
            rangeInput[0].value = maxVal - priceGap;
          } else {
            rangeInput[1].value = minVal + priceGap;
          }
        } else {
          priceInput[0].value = minVal;
          priceInput[1].value = maxVal;
          range.style.left = (minVal / rangeInput[0].max) * 100 + "%";
          range.style.right = 100 - (maxVal / rangeInput[1].max) * 100 + "%";
        }
      });
    });
  </script>
  
  <script>
    const rangeInput2 = document.querySelectorAll("#range-input2 input"),
    areaInput = document.querySelectorAll(".area-input input"),
    range2 = document.querySelector("#slide2 #progress2");
    let areaGap = 100;
  
    areaInput.forEach((input) => {
      input.addEventListener("input", (e) => {
        let minarea = parseInt(areaInput[0].value),
          maxarea = parseInt(areaInput[1].value);
  
        if (maxarea - minarea >= areaGap && maxarea <= rangeInput2[1].max) {
          if (e.target.className === "input-min") {
            rangeInput2[0].value = minarea;
            range2.style.left = (minarea / rangeInput2[0].max) * 100 + "%";
          } else {
            rangeInput2[1].value = maxarea;
            range2.style.right = 100 - (maxarea / rangeInput2[1].max) * 100 + "%";
          }
        }
      });
    });
  
    rangeInput2.forEach((input) => {
      input.addEventListener("input", (e) => {
        let minArea = parseInt(rangeInput2[0].value),
          maxArea = parseInt(rangeInput2[1].value);
  
        if (maxArea - minArea < areaGap) {
          if (e.target.className === "range-min2") {
            rangeInput2[0].value = maxArea - areaGap;
          } else {
            rangeInput2[1].value = minArea + areaGap;
          }
        } else {
          areaInput[0].value = minArea;
          areaInput[1].value = maxArea;
          range2.style.left = (minArea / rangeInput2[0].max) * 100 + "%";
          range2.style.right = 100 - (maxArea / rangeInput2[1].max) * 100 + "%";
        }
      });
    });
  </script>  



{% endblock %}